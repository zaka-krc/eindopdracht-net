<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodel="clr-namespace:SuntoryManagementSystem_App.ViewModels"
             x:Class="SuntoryManagementSystem_App.Pages.MainPage"
             x:DataType="viewmodel:MainViewModel"
             Title="Dashboard"
             BackgroundColor="White">

    <Grid RowDefinitions="Auto,*" Padding="20">
        
        <!-- Header Section -->
        <VerticalStackLayout Grid.Row="0" Spacing="10">
            
            <!-- Welcome Header -->
            <Label FontSize="28" 
                   FontAttributes="Bold"
                   TextColor="#212121">
                <Label.Text>
                    <MultiBinding StringFormat="Welkom terug, {0}!">
                        <Binding Path="GebruikersNaam" />
                    </MultiBinding>
                </Label.Text>
            </Label>
            
            <Label Text="{Binding GebruikersRol}" 
                   FontSize="16" 
                   TextColor="#666" />
            
            <!-- Last Sync Info with Refresh Button -->
            <Grid ColumnDefinitions="*,Auto" Margin="0,5,0,0">
                <Label Grid.Column="0"
                       FontSize="12" 
                       TextColor="Gray"
                       VerticalOptions="Center">
                    <Label.Text>
                        <MultiBinding StringFormat="Laatste sync: {0}">
                            <Binding Path="LaatsteSyncTijd" />
                        </MultiBinding>
                    </Label.Text>
                </Label>
                
                <Button Grid.Column="1"
                        Text="Vernieuwen"
                        FontSize="14"
                        BackgroundColor="#512BD4"
                        TextColor="White"
                        Padding="15,8"
                        CornerRadius="8"
                        Command="{Binding RefreshDataCommand}"
                        IsEnabled="{Binding IsSyncing, Converter={StaticResource InvertedBoolConverter}}" />
            </Grid>
            
            <!-- Activity Indicator -->
            <ActivityIndicator IsRunning="{Binding IsSyncing}" 
                               IsVisible="{Binding IsSyncing}"
                               Color="{StaticResource Primary}"
                               HeightRequest="30"
                               WidthRequest="30"
                               Margin="0,5,0,0" />
        </VerticalStackLayout>
        
        <!-- Main Content -->
        <ScrollView Grid.Row="1" Margin="0,15,0,0">
            <VerticalStackLayout Spacing="15">
                
                <!-- Statistics Grid -->
                <Label Text="Statistieken" 
                       FontSize="20" 
                       FontAttributes="Bold"
                       TextColor="#212121" />
                
                <Grid ColumnDefinitions="*,*" 
                      RowDefinitions="Auto,Auto"
                      ColumnSpacing="10"
                      RowSpacing="10">
                    
                    <!-- Producten -->
                    <Border Grid.Row="0" Grid.Column="0"
                            BackgroundColor="#F8F9FA"
                            StrokeThickness="1"
                            Stroke="#E0E0E0"
                            Padding="15">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="10" />
                        </Border.StrokeShape>
                        <VerticalStackLayout Spacing="5">
                            <Label Text="{Binding AantalProducten}" 
                                   FontSize="32" 
                                   FontAttributes="Bold" 
                                   HorizontalOptions="Center"
                                   TextColor="#512BD4" />
                            <Label Text="Producten" 
                                   FontSize="14" 
                                   TextColor="#666" 
                                   HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Lage Voorraad -->
                    <Border Grid.Row="0" Grid.Column="1"
                            BackgroundColor="#F8F9FA"
                            StrokeThickness="1"
                            Stroke="#E0E0E0"
                            Padding="15">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="10" />
                        </Border.StrokeShape>
                        <VerticalStackLayout Spacing="5">
                            <Label Text="{Binding LageVoorraadCount}" 
                                   FontSize="32" 
                                   FontAttributes="Bold" 
                                   HorizontalOptions="Center"
                                   TextColor="#dc3545" />
                            <Label Text="Lage Voorraad" 
                                   FontSize="14" 
                                   TextColor="#666" 
                                   HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Leveringen -->
                    <Border Grid.Row="1" Grid.Column="0"
                            BackgroundColor="#F8F9FA"
                            StrokeThickness="1"
                            Stroke="#E0E0E0"
                            Padding="15">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="10" />
                        </Border.StrokeShape>
                        <VerticalStackLayout Spacing="5">
                            <Label Text="{Binding OpenstaandeLeveringen}" 
                                   FontSize="32" 
                                   FontAttributes="Bold" 
                                   HorizontalOptions="Center"
                                   TextColor="#ffc107" />
                            <Label Text="Openstaande Leveringen" 
                                   FontSize="14" 
                                   TextColor="#666" 
                                   HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Border>

                    <!-- Klanten -->
                    <Border Grid.Row="1" Grid.Column="1"
                            BackgroundColor="#F8F9FA"
                            StrokeThickness="1"
                            Stroke="#E0E0E0"
                            Padding="15">
                        <Border.StrokeShape>
                            <RoundRectangle CornerRadius="10" />
                        </Border.StrokeShape>
                        <VerticalStackLayout Spacing="5">
                            <Label Text="{Binding ActieveKlanten}" 
                                   FontSize="32" 
                                   FontAttributes="Bold" 
                                   HorizontalOptions="Center"
                                   TextColor="#28a745" />
                            <Label Text="Actieve Klanten" 
                                   FontSize="14" 
                                   TextColor="#666" 
                                   HorizontalOptions="Center" />
                        </VerticalStackLayout>
                    </Border>
                </Grid>

                <!-- Lage Voorraad Waarschuwingen -->
                <VerticalStackLayout Spacing="10" Margin="0,10,0,0">
                    <Label Text="Lage Voorraad Waarschuwingen" 
                           FontSize="20" 
                           FontAttributes="Bold"
                           TextColor="#212121" />
                    
                    <CollectionView ItemsSource="{Binding VoorraadWaarschuwingen}">
                        <CollectionView.EmptyView>
                            <Border BackgroundColor="#D1FAE5" 
                                    StrokeThickness="1"
                                    Stroke="#10B981"
                                    Padding="15">
                                <Border.StrokeShape>
                                    <RoundRectangle CornerRadius="8" />
                                </Border.StrokeShape>
                                <Label Text="Geen waarschuwingen - Alle producten hebben voldoende voorraad" 
                                       TextColor="#065F46"
                                       FontSize="14" 
                                       HorizontalOptions="Center" />
                            </Border>
                        </CollectionView.EmptyView>
                        
                        <CollectionView.ItemTemplate>
                            <DataTemplate x:DataType="x:String">
                                <Border BackgroundColor="#FEF3C7" 
                                        StrokeThickness="1"
                                        Stroke="#F59E0B"
                                        Padding="12" 
                                        Margin="0,5">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="8" />
                                    </Border.StrokeShape>
                                    <Label Text="{Binding .}" 
                                           TextColor="#92400E"
                                           FontSize="14" />
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>
                </VerticalStackLayout>

                <!-- Snelle Acties -->
                <VerticalStackLayout Spacing="10" Margin="0,10,0,0">
                    <Label Text="Snelle Acties" 
                           FontSize="20" 
                           FontAttributes="Bold"
                           TextColor="#212121" />
                    
                    <Button Text="Nieuw Product Toevoegen" 
                            FontSize="16"
                            BackgroundColor="#28a745"
                            TextColor="White"
                            HeightRequest="50"
                            CornerRadius="10"
                            Command="{Binding NieuwProductCommand}" />
                    
                    <Button Text="Nieuwe Levering Toevoegen" 
                            FontSize="16"
                            BackgroundColor="#007bff"
                            TextColor="White"
                            HeightRequest="50"
                            CornerRadius="10"
                            Command="{Binding NieuweLeveringCommand}" />
                    
                    <Button Text="Nieuwe Klant Toevoegen" 
                            FontSize="16"
                            BackgroundColor="#17a2b8"
                            TextColor="White"
                            HeightRequest="50"
                            CornerRadius="10"
                            Command="{Binding NieuweKlantCommand}" />
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>
    </Grid>

</ContentPage>
